<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Questionnaire - Material Design 3</title>
    
    <!-- Material Design 3 Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    
    <!-- Material Web Components -->
    <script type="importmap">
    {
        "imports": {
            "@material/web/": "https://esm.run/@material/web/"
        }
    }
    </script>
    <script type="module">
        import '@material/web/all.js';
        import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';
        document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
    </script>

    <style>
        :root {
            /* Material Design 3 Color Tokens - Light Theme */
            --md-sys-color-primary: #6750A4;
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-primary-container: #EADDFF;
            --md-sys-color-on-primary-container: #21005D;
            --md-sys-color-secondary: #625B71;
            --md-sys-color-on-secondary: #FFFFFF;
            --md-sys-color-secondary-container: #E8DEF8;
            --md-sys-color-on-secondary-container: #1D192B;
            --md-sys-color-tertiary: #7D5260;
            --md-sys-color-on-tertiary: #FFFFFF;
            --md-sys-color-tertiary-container: #FFD8E4;
            --md-sys-color-on-tertiary-container: #31111D;
            --md-sys-color-error: #BA1A1A;
            --md-sys-color-on-error: #FFFFFF;
            --md-sys-color-error-container: #FFDAD6;
            --md-sys-color-on-error-container: #410002;
            --md-sys-color-background: #FFFBFE;
            --md-sys-color-on-background: #1C1B1F;
            --md-sys-color-surface: #FFFBFE;
            --md-sys-color-on-surface: #1C1B1F;
            --md-sys-color-surface-variant: #E7E0EC;
            --md-sys-color-on-surface-variant: #49454F;
            --md-sys-color-outline: #79747E;
            --md-sys-color-outline-variant: #CAC4D0;
            --md-sys-color-shadow: #000000;
            --md-sys-color-scrim: #000000;
            --md-sys-color-inverse-surface: #313033;
            --md-sys-color-inverse-on-surface: #F4EFF4;
            --md-sys-color-inverse-primary: #D0BCFF;
            --md-sys-color-success: #146C2E;
            --md-sys-color-on-success: #FFFFFF;
            
            /* Material Motion Easing */
            --md-sys-motion-easing-standard: cubic-bezier(0.2, 0, 0, 1);
            --md-sys-motion-easing-emphasized: cubic-bezier(0.05, 0.7, 0.1, 1);
            --md-sys-motion-duration-short1: 50ms;
            --md-sys-motion-duration-short2: 100ms;
            --md-sys-motion-duration-short3: 150ms;
            --md-sys-motion-duration-short4: 200ms;
            --md-sys-motion-duration-medium1: 250ms;
            --md-sys-motion-duration-medium2: 300ms;
            --md-sys-motion-duration-medium3: 350ms;
            --md-sys-motion-duration-medium4: 400ms;
            --md-sys-motion-duration-long1: 450ms;
            --md-sys-motion-duration-long2: 500ms;
            
            /* Elevation */
            --md-sys-elevation-level0: none;
            --md-sys-elevation-level1: 0px 1px 2px 0px rgba(0, 0, 0, 0.3), 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
            --md-sys-elevation-level2: 0px 1px 2px 0px rgba(0, 0, 0, 0.3), 0px 2px 6px 2px rgba(0, 0, 0, 0.15);
            --md-sys-elevation-level3: 0px 1px 3px 0px rgba(0, 0, 0, 0.3), 0px 4px 8px 3px rgba(0, 0, 0, 0.15);
            --md-sys-elevation-level4: 0px 2px 3px 0px rgba(0, 0, 0, 0.3), 0px 6px 10px 4px rgba(0, 0, 0, 0.15);
            --md-sys-elevation-level5: 0px 4px 4px 0px rgba(0, 0, 0, 0.3), 0px 8px 12px 6px rgba(0, 0, 0, 0.15);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--md-sys-color-background);
            color: var(--md-sys-color-on-background);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Main Layout */
        .questionnaire-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            min-height: calc(100vh - 64px);
            display: grid;
            grid-template-rows: auto 1fr auto;
            gap: 24px;
        }

        /* Top App Bar Styling */
        md-top-app-bar {
            --md-top-app-bar-container-color: var(--md-sys-color-surface);
            --md-top-app-bar-headline-color: var(--md-sys-color-on-surface);
            box-shadow: var(--md-sys-elevation-level2);
        }

        /* Progress Section */
        .progress-section {
            display: flex;
            flex-direction: column;
            gap: 16px;
            padding: 24px 0;
            animation: slideInFromTop var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .progress-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface-variant);
            letter-spacing: 0.1px;
        }

        .step-counter {
            background: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        md-linear-progress {
            --md-linear-progress-active-indicator-color: var(--md-sys-color-primary);
            --md-linear-progress-track-color: var(--md-sys-color-surface-variant);
            height: 4px;
            border-radius: 2px;
        }

        /* Question Section */
        .question-section {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 24px 0;
            min-height: 500px;
        }

        .question-card {
            background: var(--md-sys-color-surface);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: 24px;
            padding: 32px;
            max-width: 800px;
            width: 100%;
            box-shadow: var(--md-sys-elevation-level1);
            transition: all var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard);
            animation: slideInFromBottom var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
        }

        .question-card:hover {
            box-shadow: var(--md-sys-elevation-level2);
        }

        .question-title {
            font-size: 28px;
            font-weight: 400;
            line-height: 36px;
            color: var(--md-sys-color-on-surface);
            margin: 0 0 16px 0;
            letter-spacing: 0px;
        }

        .question-description {
            font-size: 16px;
            font-weight: 400;
            line-height: 24px;
            color: var(--md-sys-color-on-surface-variant);
            margin: 0 0 32px 0;
            letter-spacing: 0.5px;
        }

        .question-content {
            margin-bottom: 24px;
        }

        /* Input Components */
        .input-group {
            margin-bottom: 24px;
        }

        md-outlined-text-field {
            width: 100%;
            --md-outlined-text-field-container-shape: 12px;
            --md-outlined-field-focus-outline-color: var(--md-sys-color-primary);
            --md-outlined-field-outline-color: var(--md-sys-color-outline);
        }

        md-outlined-text-field.error {
            --md-outlined-field-focus-outline-color: var(--md-sys-color-error);
            --md-outlined-field-outline-color: var(--md-sys-color-error);
            animation: shake var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard);
        }

        /* Multiple Choice Options */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-item {
            display: flex;
            align-items: center;
            padding: 16px;
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: 12px;
            cursor: pointer;
            transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
            background: var(--md-sys-color-surface);
        }

        .option-item:hover {
            background: var(--md-sys-color-surface-variant);
            border-color: var(--md-sys-color-outline);
            box-shadow: var(--md-sys-elevation-level1);
        }

        .option-item.selected {
            background: var(--md-sys-color-primary-container);
            border-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary-container);
        }

        .option-text {
            margin-left: 12px;
            font-size: 16px;
            font-weight: 400;
            line-height: 24px;
        }

        /* Rating Scale */
        .rating-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .rating-scale {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .rating-button {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid var(--md-sys-color-outline-variant);
            background: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rating-button:hover {
            background: var(--md-sys-color-primary-container);
            border-color: var(--md-sys-color-primary);
            transform: scale(1.1);
        }

        .rating-button.selected {
            background: var(--md-sys-color-primary);
            border-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            box-shadow: var(--md-sys-elevation-level2);
        }

        .rating-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--md-sys-color-on-surface-variant);
            margin-top: 8px;
        }

        /* Checkbox Group */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            transition: background-color var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
        }

        .checkbox-item:hover {
            background: var(--md-sys-color-surface-variant);
        }

        /* Navigation Section */
        .navigation-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 0;
            border-top: 1px solid var(--md-sys-color-outline-variant);
            animation: slideInFromBottom var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
        }

        .nav-buttons {
            display: flex;
            gap: 16px;
        }

        md-text-button, md-filled-button, md-filled-tonal-button {
            --md-filled-button-container-shape: 20px;
            --md-filled-tonal-button-container-shape: 20px;
            --md-text-button-container-shape: 20px;
            min-width: 120px;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 48px 32px;
        }

        .welcome-illustration {
            width: 200px;
            height: 200px;
            margin: 0 auto 32px;
            background: linear-gradient(135deg, var(--md-sys-color-primary), var(--md-sys-color-tertiary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: bounceIn var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
        }

        .welcome-icon {
            font-size: 80px;
            color: var(--md-sys-color-on-primary);
        }

        .welcome-title {
            font-size: 32px;
            font-weight: 400;
            line-height: 40px;
            color: var(--md-sys-color-on-surface);
            margin: 0 0 16px 0;
        }

        .welcome-subtitle {
            font-size: 16px;
            font-weight: 400;
            line-height: 24px;
            color: var(--md-sys-color-on-surface-variant);
            margin: 0 0 32px 0;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Results Screen */
        .results-screen {
            text-align: center;
            padding: 48px 32px;
        }

        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
            margin: 32px 0;
        }

        .result-card {
            background: var(--md-sys-color-surface);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            box-shadow: var(--md-sys-elevation-level1);
            transition: all var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard);
            animation: slideInFromBottom var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
        }

        .result-card:hover {
            box-shadow: var(--md-sys-elevation-level3);
            transform: translateY(-4px);
        }

        .result-icon {
            font-size: 48px;
            color: var(--md-sys-color-primary);
            margin-bottom: 16px;
        }

        .result-title {
            font-size: 18px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface);
            margin: 0 0 8px 0;
        }

        .result-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--md-sys-color-primary);
            margin: 0;
        }

        /* Animations */
        @keyframes slideInFromTop {
            from {
                opacity: 0;
                transform: translateY(-40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInFromBottom {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInFromLeft {
            from {
                opacity: 0;
                transform: translateX(-40px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(40px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            10%, 30%, 50%, 70%, 90% {
                transform: translateX(-4px);
            }
            20%, 40%, 60%, 80% {
                transform: translateX(4px);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideOutLeft {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(-100%);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        /* Success State */
        .success-message {
            background: var(--md-sys-color-success);
            color: var(--md-sys-color-on-success);
            padding: 16px 24px;
            border-radius: 12px;
            margin: 16px 0;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInFromBottom var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard);
        }

        /* Error State */
        .error-message {
            background: var(--md-sys-color-error-container);
            color: var(--md-sys-color-on-error-container);
            padding: 16px 24px;
            border-radius: 12px;
            margin: 16px 0;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInFromBottom var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard);
        }

        /* Loading State */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard);
        }

        .loading-content {
            background: var(--md-sys-color-surface);
            border-radius: 24px;
            padding: 48px;
            text-align: center;
            box-shadow: var(--md-sys-elevation-level5);
            animation: bounceIn var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .questionnaire-container {
                padding: 0 16px;
            }
            
            .question-card {
                padding: 24px;
                border-radius: 16px;
            }
            
            .question-title {
                font-size: 24px;
                line-height: 32px;
            }
            
            .welcome-illustration {
                width: 150px;
                height: 150px;
            }
            
            .welcome-icon {
                font-size: 60px;
            }
            
            .rating-scale {
                flex-wrap: wrap;
                gap: 12px;
            }
            
            .rating-button {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
            
            .results-summary {
                grid-template-columns: 1fr;
            }
        }

        /* Focus Styles for Accessibility */
        *:focus-visible {
            outline: 2px solid var(--md-sys-color-primary);
            outline-offset: 2px;
        }

        /* Hidden class for transitions */
        .hidden {
            display: none !important;
        }

        .fade-out {
            animation: fadeOut var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard) forwards;
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        /* Slide transition classes */
        .slide-out-left {
            animation: slideOutLeft var(--md-sys-motion-duration-medium3) var(--md-sys-motion-easing-standard) forwards;
        }

        .slide-out-right {
            animation: slideOutRight var(--md-sys-motion-duration-medium3) var(--md-sys-motion-easing-standard) forwards;
        }

        .slide-in-left {
            animation: slideInFromLeft var(--md-sys-motion-duration-medium3) var(--md-sys-motion-easing-standard) forwards;
        }

        .slide-in-right {
            animation: slideInFromRight var(--md-sys-motion-duration-medium3) var(--md-sys-motion-easing-standard) forwards;
        }
    </style>
</head>
<body>
    <!-- Top App Bar -->
    <md-top-app-bar type="small">
        <md-icon-button slot="navigation" onclick="showMenu()">
            <md-icon>menu</md-icon>
        </md-icon-button>
        <div slot="headline">Interactive Questionnaire</div>
        <md-icon-button slot="action" onclick="showHelp()">
            <md-icon>help</md-icon>
        </md-icon-button>
        <md-icon-button slot="action" onclick="toggleTheme()">
            <md-icon>light_mode</md-icon>
        </md-icon-button>
    </md-top-app-bar>

    <!-- Main Container -->
    <main class="questionnaire-container">
        <!-- Progress Section -->
        <section class="progress-section">
            <div class="progress-header">
                <span class="progress-text" id="progressText">Getting started...</span>
                <span class="step-counter" id="stepCounter">Step 1 of 8</span>
            </div>
            <md-linear-progress id="progressBar" value="0" max="8"></md-linear-progress>
        </section>

        <!-- Question Section -->
        <section class="question-section">
            <div class="question-card" id="questionCard">
                <!-- Dynamic content will be inserted here -->
            </div>
        </section>

        <!-- Navigation Section -->
        <section class="navigation-section">
            <div class="nav-buttons">
                <md-text-button id="prevButton" onclick="previousQuestion()" disabled>
                    <md-icon slot="icon">arrow_back</md-icon>
                    Previous
                </md-text-button>
            </div>
            <div class="nav-buttons">
                <md-filled-button id="nextButton" onclick="nextQuestion()" disabled>
                    Next
                    <md-icon slot="icon">arrow_forward</md-icon>
                </md-filled-button>
            </div>
        </section>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-content">
            <md-circular-progress indeterminate></md-circular-progress>
            <h3 style="margin: 24px 0 8px 0; color: var(--md-sys-color-on-surface);">Processing your responses...</h3>
            <p style="margin: 0; color: var(--md-sys-color-on-surface-variant);">This will just take a moment</p>
        </div>
    </div>

    <script>
        // Questionnaire State Management
        class QuestionnaireState {
            constructor() {
                this.currentStep = 0;
                this.totalSteps = 8;
                this.answers = {};
                this.isAnimating = false;
                this.questions = this.initializeQuestions();
            }

            initializeQuestions() {
                return [
                    {
                        id: 'welcome',
                        type: 'welcome',
                        title: 'Welcome to Our Interactive Questionnaire',
                        description: 'We\'d love to learn more about you and your preferences. This will take approximately 5 minutes to complete.',
                        content: this.createWelcomeContent(),
                        validation: () => true
                    },
                    {
                        id: 'name',
                        type: 'text',
                        title: 'What\'s your name?',
                        description: 'Please enter your full name so we can personalize your experience.',
                        content: this.createTextInputContent('name', 'Enter your full name', 'person'),
                        validation: (answer) => answer && answer.trim().length >= 2
                    },
                    {
                        id: 'workStyle',
                        type: 'multiple-choice',
                        title: 'What\'s your preferred working style?',
                        description: 'Choose the option that best describes how you like to work.',
                        content: this.createMultipleChoiceContent('workStyle', [
                            { value: 'collaborative', label: 'Collaborative - I work best in teams', icon: 'groups' },
                            { value: 'independent', label: 'Independent - I prefer working alone', icon: 'person' },
                            { value: 'hybrid', label: 'Hybrid - I like both depending on the task', icon: 'swap_horiz' },
                            { value: 'leadership', label: 'Leadership - I enjoy leading and guiding others', icon: 'supervisor_account' }
                        ]),
                        validation: (answer) => answer !== undefined
                    },
                    {
                        id: 'experience',
                        type: 'rating',
                        title: 'Rate your experience with our service',
                        description: 'On a scale of 1-10, how would you rate your overall experience?',
                        content: this.createRatingContent('experience', 1, 10),
                        validation: (answer) => answer >= 1 && answer <= 10
                    },
                    {
                        id: 'interests',
                        type: 'multi-select',
                        title: 'Which features interest you most?',
                        description: 'Select all that apply. This helps us understand your priorities.',
                        content: this.createMultiSelectContent('interests', [
                            { value: 'analytics', label: 'Advanced Analytics', icon: 'analytics' },
                            { value: 'automation', label: 'Process Automation', icon: 'smart_toy' },
                            { value: 'integration', label: 'Third-party Integrations', icon: 'integration_instructions' },
                            { value: 'mobile', label: 'Mobile Applications', icon: 'phone_android' },
                            { value: 'security', label: 'Enhanced Security', icon: 'security' },
                            { value: 'collaboration', label: 'Team Collaboration', icon: 'group_work' }
                        ]),
                        validation: (answer) => answer && answer.length > 0
                    },
                    {
                        id: 'schedule',
                        type: 'date',
                        title: 'When would you like to schedule a follow-up?',
                        description: 'Select a preferred date for our team to reach out to you.',
                        content: this.createDateInputContent('schedule'),
                        validation: (answer) => {
                            if (!answer) return false;
                            const selectedDate = new Date(answer);
                            const today = new Date();
                            today.setHours(0, 0, 0, 0);
                            return selectedDate >= today;
                        }
                    },
                    {
                        id: 'feedback',
                        type: 'textarea',
                        title: 'Tell us more about your needs',
                        description: 'Please share any additional information, requirements, or feedback that would help us serve you better.',
                        content: this.createTextAreaContent('feedback', 'Share your thoughts, requirements, or any additional information...'),
                        validation: (answer) => !answer || answer.trim().length <= 1000
                    },
                    {
                        id: 'results',
                        type: 'results',
                        title: 'Thank you for completing our questionnaire!',
                        description: 'Here\'s a summary of your responses and our recommendations.',
                        content: this.createResultsContent(),
                        validation: () => true
                    }
                ];
            }

            createWelcomeContent() {
                return `
                    <div class="welcome-screen">
                        <div class="welcome-illustration">
                            <md-icon class="welcome-icon">quiz</md-icon>
                        </div>
                        <h1 class="welcome-title">Welcome to Our Interactive Questionnaire</h1>
                        <p class="welcome-subtitle">
                            We're excited to learn more about you! This questionnaire will help us understand your preferences 
                            and provide you with a personalized experience. It should take about 5 minutes to complete.
                        </p>
                        <div style="margin-top: 32px;">
                            <md-filled-button onclick="nextQuestion()">
                                Get Started
                                <md-icon slot="icon">arrow_forward</md-icon>
                            </md-filled-button>
                        </div>
                    </div>
                `;
            }

            createTextInputContent(id, placeholder, icon = 'edit') {
                return `
                    <div class="input-group">
                        <md-outlined-text-field 
                            id="${id}Input" 
                            label="${placeholder}"
                            placeholder="${placeholder}"
                            onkeyup="handleTextInput('${id}')"
                            onchange="handleTextInput('${id}')"
                        >
                            <md-icon slot="leading-icon">${icon}</md-icon>
                        </md-outlined-text-field>
                    </div>
                `;
            }

            createMultipleChoiceContent(id, options) {
                let content = '<div class="options-container">';
                options.forEach((option, index) => {
                    content += `
                        <div class="option-item" onclick="selectOption('${id}', '${option.value}')">
                            <md-radio id="${id}_${option.value}" name="${id}" value="${option.value}"></md-radio>
                            <md-icon style="margin-left: 12px; color: var(--md-sys-color-primary);">${option.icon}</md-icon>
                            <span class="option-text">${option.label}</span>
                        </div>
                    `;
                });
                content += '</div>';
                return content;
            }

            createRatingContent(id, min, max) {
                let content = `
                    <div class="rating-container">
                        <div class="rating-scale">
                `;
                for (let i = min; i <= max; i++) {
                    content += `
                        <button class="rating-button" onclick="selectRating('${id}', ${i})" data-value="${i}">
                            ${i}
                        </button>
                    `;
                }
                content += `
                        </div>
                        <div class="rating-labels">
                            <span>Poor</span>
                            <span>Excellent</span>
                        </div>
                    </div>
                `;
                return content;
            }

            createMultiSelectContent(id, options) {
                let content = '<div class="checkbox-group">';
                options.forEach((option, index) => {
                    content += `
                        <div class="checkbox-item" onclick="toggleCheckbox('${id}', '${option.value}')">
                            <md-checkbox id="${id}_${option.value}" value="${option.value}" onchange="handleCheckboxChange('${id}')"></md-checkbox>
                            <md-icon style="margin-left: 12px; color: var(--md-sys-color-primary);">${option.icon}</md-icon>
                            <span class="option-text" style="margin-left: 12px;">${option.label}</span>
                        </div>
                    `;
                });
                content += '</div>';
                return content;
            }

            createDateInputContent(id) {
                const today = new Date().toISOString().split('T')[0];
                return `
                    <div class="input-group">
                        <md-outlined-text-field 
                            id="${id}Input" 
                            type="date"
                            label="Select Date"
                            min="${today}"
                            onchange="handleDateInput('${id}')"
                        >
                            <md-icon slot="leading-icon">calendar_today</md-icon>
                        </md-outlined-text-field>
                    </div>
                `;
            }

            createTextAreaContent(id, placeholder) {
                return `
                    <div class="input-group">
                        <md-outlined-text-field 
                            id="${id}Input" 
                            type="textarea"
                            label="${placeholder}"
                            placeholder="${placeholder}"
                            rows="4"
                            maxlength="1000"
                            onkeyup="handleTextInput('${id}')"
                            onchange="handleTextInput('${id}')"
                        >
                            <md-icon slot="leading-icon">message</md-icon>
                        </md-outlined-text-field>
                    </div>
                `;
            }

            createResultsContent() {
                const answers = this.answers;
                return `
                    <div class="results-screen">
                        <div class="welcome-illustration">
                            <md-icon class="welcome-icon">check_circle</md-icon>
                        </div>
                        <h1 class="welcome-title">Thank You, ${answers.name || 'Friend'}!</h1>
                        <p class="welcome-subtitle">
                            We've received your responses and will use them to provide you with a personalized experience. 
                            Here's a summary of what we learned about you:
                        </p>
                        
                        <div class="results-summary">
                            <div class="result-card">
                                <md-icon class="result-icon">person</md-icon>
                                <h3 class="result-title">Profile</h3>
                                <p class="result-value">${answers.name || 'Anonymous'}</p>
                            </div>
                            
                            <div class="result-card">
                                <md-icon class="result-icon">work</md-icon>
                                <h3 class="result-title">Work Style</h3>
                                <p class="result-value">${this.getWorkStyleLabel(answers.workStyle)}</p>
                            </div>
                            
                            <div class="result-card">
                                <md-icon class="result-icon">star</md-icon>
                                <h3 class="result-title">Experience Rating</h3>
                                <p class="result-value">${answers.experience || 'N/A'}/10</p>
                            </div>
                            
                            <div class="result-card">
                                <md-icon class="result-icon">interests</md-icon>
                                <h3 class="result-title">Interests</h3>
                                <p class="result-value">${answers.interests ? answers.interests.length : 0} selected</p>
                            </div>
                        </div>
                        
                        <div style="margin-top: 32px;">
                            <md-filled-button onclick="downloadResults()" style="margin-right: 16px;">
                                <md-icon slot="icon">download</md-icon>
                                Download Summary
                            </md-filled-button>
                            <md-filled-tonal-button onclick="restartQuestionnaire()">
                                <md-icon slot="icon">refresh</md-icon>
                                Start Over
                            </md-filled-tonal-button>
                        </div>
                    </div>
                `;
            }

            getWorkStyleLabel(value) {
                const labels = {
                    'collaborative': 'Collaborative',
                    'independent': 'Independent',
                    'hybrid': 'Hybrid',
                    'leadership': 'Leadership'
                };
                return labels[value] || 'Not specified';
            }

            getCurrentQuestion() {
                return this.questions[this.currentStep];
            }

            setAnswer(questionId, answer) {
                this.answers[questionId] = answer;
                this.validateCurrentQuestion();
            }

            getAnswer(questionId) {
                return this.answers[questionId];
            }

            validateCurrentQuestion() {
                const question = this.getCurrentQuestion();
                const answer = this.getAnswer(question.id);
                const isValid = question.validation(answer);
                
                const nextButton = document.getElementById('nextButton');
                nextButton.disabled = !isValid;
                
                return isValid;
            }

            nextStep() {
                if (this.currentStep < this.totalSteps - 1) {
                    this.currentStep++;
                    return true;
                }
                return false;
            }

            prevStep() {
                if (this.currentStep > 0) {
                    this.currentStep--;
                    return true;
                }
                return false;
            }

            getProgress() {
                return (this.currentStep / (this.totalSteps - 1)) * 100;
            }
        }

        // Initialize questionnaire
        const questionnaire = new QuestionnaireState();

        // DOM Management Functions
        function updateUI() {
            updateProgress();
            updateQuestion();
            updateNavigation();
        }

        function updateProgress() {
            const progressText = document.getElementById('progressText');
            const stepCounter = document.getElementById('stepCounter');
            const progressBar = document.getElementById('progressBar');
            
            const currentQuestion = questionnaire.getCurrentQuestion();
            const progress = questionnaire.getProgress();
            
            progressText.textContent = getProgressText(currentQuestion.type);
            stepCounter.textContent = `Step ${questionnaire.currentStep + 1} of ${questionnaire.totalSteps}`;
            progressBar.value = questionnaire.currentStep;
        }

        function getProgressText(questionType) {
            const texts = {
                'welcome': 'Getting started...',
                'text': 'Personal information',
                'multiple-choice': 'Preferences',
                'rating': 'Feedback',
                'multi-select': 'Interests',
                'date': 'Scheduling',
                'textarea': 'Additional input',
                'results': 'Complete!'
            };
            return texts[questionType] || 'In progress...';
        }

        function updateQuestion() {
            const questionCard = document.getElementById('questionCard');
            const currentQuestion = questionnaire.getCurrentQuestion();
            
            // Create new content
            const newContent = `
                <h2 class="question-title">${currentQuestion.title}</h2>
                <p class="question-description">${currentQuestion.description}</p>
                <div class="question-content">
                    ${currentQuestion.content}
                </div>
            `;
            
            // Apply slide transition
            questionCard.style.opacity = '0';
            questionCard.style.transform = 'translateX(20px)';
            
            setTimeout(() => {
                questionCard.innerHTML = newContent;
                questionCard.style.opacity = '1';
                questionCard.style.transform = 'translateX(0)';
                
                // Restore previous answers
                restoreAnswers(currentQuestion);
                
                // Validate current question
                questionnaire.validateCurrentQuestion();
            }, 150);
        }

        function restoreAnswers(question) {
            const answer = questionnaire.getAnswer(question.id);
            if (!answer) return;

            switch (question.type) {
                case 'text':
                case 'textarea':
                case 'date':
                    const input = document.getElementById(question.id + 'Input');
                    if (input) input.value = answer;
                    break;
                    
                case 'multiple-choice':
                    const radio = document.getElementById(`${question.id}_${answer}`);
                    if (radio) {
                        radio.checked = true;
                        radio.closest('.option-item').classList.add('selected');
                    }
                    break;
                    
                case 'rating':
                    const ratingButton = document.querySelector(`[data-value="${answer}"]`);
                    if (ratingButton) {
                        ratingButton.classList.add('selected');
                    }
                    break;
                    
                case 'multi-select':
                    if (Array.isArray(answer)) {
                        answer.forEach(value => {
                            const checkbox = document.getElementById(`${question.id}_${value}`);
                            if (checkbox) checkbox.checked = true;
                        });
                    }
                    break;
            }
        }

        function updateNavigation() {
            const prevButton = document.getElementById('prevButton');
            const nextButton = document.getElementById('nextButton');
            const currentQuestion = questionnaire.getCurrentQuestion();
            
            // Update previous button
            prevButton.disabled = questionnaire.currentStep === 0;
            
            // Update next button text and behavior
            if (questionnaire.currentStep === questionnaire.totalSteps - 1) {
                nextButton.innerHTML = '<md-icon slot="icon">check</md-icon>Finish';
            } else if (currentQuestion.type === 'welcome') {
                nextButton.innerHTML = 'Get Started<md-icon slot="icon">arrow_forward</md-icon>';
                nextButton.disabled = false;
            } else {
                nextButton.innerHTML = 'Next<md-icon slot="icon">arrow_forward</md-icon>';
            }
        }

        // Input Handlers
        function handleTextInput(questionId) {
            const input = document.getElementById(questionId + 'Input');
            questionnaire.setAnswer(questionId, input.value);
        }

        function selectOption(questionId, value) {
            // Update radio button
            const radio = document.getElementById(`${questionId}_${value}`);
            radio.checked = true;
            
            // Update visual selection
            document.querySelectorAll('.option-item').forEach(item => {
                item.classList.remove('selected');
            });
            radio.closest('.option-item').classList.add('selected');
            
            questionnaire.setAnswer(questionId, value);
            
            // Add subtle animation
            radio.closest('.option-item').style.transform = 'scale(0.98)';
            setTimeout(() => {
                radio.closest('.option-item').style.transform = 'scale(1)';
            }, 100);
        }

        function selectRating(questionId, rating) {
            // Update visual selection
            document.querySelectorAll('.rating-button').forEach(button => {
                button.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            questionnaire.setAnswer(questionId, rating);
            
            // Add ripple effect
            event.target.style.transform = 'scale(0.9)';
            setTimeout(() => {
                event.target.style.transform = 'scale(1)';
            }, 150);
        }

        function toggleCheckbox(questionId, value) {
            const checkbox = document.getElementById(`${questionId}_${value}`);
            checkbox.checked = !checkbox.checked;
            handleCheckboxChange(questionId);
        }

        function handleCheckboxChange(questionId) {
            const checkboxes = document.querySelectorAll(`[id^="${questionId}_"]`);
            const selectedValues = [];
            
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    selectedValues.push(checkbox.value);
                }
            });
            
            questionnaire.setAnswer(questionId, selectedValues);
        }

        function handleDateInput(questionId) {
            const input = document.getElementById(questionId + 'Input');
            questionnaire.setAnswer(questionId, input.value);
        }

        // Navigation Functions
        function nextQuestion() {
            if (questionnaire.isAnimating) return;
            
            const currentQuestion = questionnaire.getCurrentQuestion();
            const answer = questionnaire.getAnswer(currentQuestion.id);
            
            // Validate current question
            if (!currentQuestion.validation(answer)) {
                showError('Please complete this question before continuing.');
                return;
            }
            
            // Special handling for results screen
            if (currentQuestion.type === 'results') {
                return;
            }
            
            questionnaire.isAnimating = true;
            
            // Show loading for final submission
            if (questionnaire.currentStep === questionnaire.totalSteps - 2) {
                showLoading(true);
                setTimeout(() => {
                    showLoading(false);
                    questionnaire.nextStep();
                    updateUI();
                    questionnaire.isAnimating = false;
                }, 2000);
                return;
            }
            
            // Normal transition
            if (questionnaire.nextStep()) {
                updateUIWithTransition('next');
            }
            
            setTimeout(() => {
                questionnaire.isAnimating = false;
            }, 400);
        }

        function previousQuestion() {
            if (questionnaire.isAnimating || questionnaire.currentStep === 0) return;
            
            questionnaire.isAnimating = true;
            
            if (questionnaire.prevStep()) {
                updateUIWithTransition('prev');
            }
            
            setTimeout(() => {
                questionnaire.isAnimating = false;
            }, 400);
        }

        function updateUIWithTransition(direction) {
            const questionCard = document.getElementById('questionCard');
            
            // Exit animation
            questionCard.style.animation = direction === 'next' ? 
                'slideOutLeft 300ms var(--md-sys-motion-easing-standard) forwards' :
                'slideOutRight 300ms var(--md-sys-motion-easing-standard) forwards';
            
            setTimeout(() => {
                updateUI();
                
                // Enter animation
                questionCard.style.animation = direction === 'next' ?
                    'slideInFromRight 300ms var(--md-sys-motion-easing-standard) forwards' :
                    'slideInFromLeft 300ms var(--md-sys-motion-easing-standard) forwards';
            }, 300);
        }

        // Utility Functions
        function showError(message) {
            const existingError = document.querySelector('.error-message');
            if (existingError) {
                existingError.remove();
            }
            
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.innerHTML = `
                <md-icon>error</md-icon>
                <span>${message}</span>
            `;
            
            const questionCard = document.getElementById('questionCard');
            questionCard.appendChild(errorDiv);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
        }

        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.remove('hidden');
            } else {
                overlay.classList.add('hidden');
            }
        }

        function downloadResults() {
            const results = {
                name: questionnaire.answers.name,
                workStyle: questionnaire.answers.workStyle,
                experience: questionnaire.answers.experience,
                interests: questionnaire.answers.interests,
                schedule: questionnaire.answers.schedule,
                feedback: questionnaire.answers.feedback,
                completedAt: new Date().toISOString()
            };
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(results, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "questionnaire_results.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }

        function restartQuestionnaire() {
            questionnaire.currentStep = 0;
            questionnaire.answers = {};
            updateUI();
        }

        function showMenu() {
            // Implementation for menu functionality
            console.log('Menu clicked');
        }

        function showHelp() {
            alert('This is an interactive questionnaire built with Material Design 3. Navigate through the questions using the Previous and Next buttons. Your progress is automatically saved as you go.');
        }

        function toggleTheme() {
            // For this demo, we'll just show a message
            alert('Theme toggle functionality would be implemented here. Currently showing Light Mode.');
        }

        // Initialize the questionnaire when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateUI();
            
            // Add keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    const nextButton = document.getElementById('nextButton');
                    if (!nextButton.disabled) {
                        nextQuestion();
                    }
                } else if (e.key === 'Escape') {
                    const prevButton = document.getElementById('prevButton');
                    if (!prevButton.disabled) {
                        previousQuestion();
                    }
                }
            });
        });
    </script>
</body>
</html>
